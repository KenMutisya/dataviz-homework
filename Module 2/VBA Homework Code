Sub vbafinalhomework()'Loop through all worksheets    For Each ws In Worksheets'Opening ticker priceDim opening As Double'Closing ticker priceDim closing As Double'Difference ticker priceDim difference As Double'Percent change variableDim percent As Double'Ticker name variablesDim tickername As StringDim tickernamehard1 As StringDim tickernamehard2 As StringDim tickernamehard3 As String'Total volume variableDim totalvolume As Doubletotalvolume = 0'Max/min percent variable, max volumeDim maxpercentinitial As DoubleDim minpercentinitial As DoubleDim maxvolumeinitial As DoubleDim maxpercent As DoubleDim minpercent As DoubleDim maxvolume As Double'Keep track of the location for each ticker in the summary table  Dim sumtablerow As Integer  sumtablerow = 2  'Set total rows for the for loop    Dim lastrow As Long    lastrow = ws.Cells(Rows.Count, 1).End(xlUp).Row    'Set hard challenge rows    Dim lastrowhard As Long    'Set summary table headers    ws.Cells(1, 9).Value = "Ticker"    ws.Cells(1, 10).Value = "Yearly Change"    ws.Cells(1, 11).Value = "Percent Change"    ws.Cells(1, 12).Value = "Total Stock Volume"    'Set hard challenge table headers    ws.Cells(2, 15).Value = "Greatest % Increase"    ws.Cells(3, 15).Value = "Greatest % Decrease"    ws.Cells(4, 15).Value = "Greatest Total Volume"    ws.Cells(1, 16).Value = "Ticker"    ws.Cells(1, 17).Value = "Value"'Set row variable for ticker open/close    Dim d As Double    d = 2    'Loop through to the end of each ticker  For i = 2 To lastrow      'Set opening value    opening = ws.Cells(d, 3).Value        'Same ticker? If not...        If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then            'Set the ticker        tickername = ws.Cells(i, 1).Value        'Add to the total volume        totalvolume = totalvolume + ws.Cells(i, 7).Value              'Set closing value        closing = ws.Cells(i, 6).Value            'Set difference between opening and closing        difference = closing - opening        ws.Range("J" & sumtablerow).Value = difference                    'Set positive and negative change color                If difference >= 0 Then                ws.Range("J" & sumtablerow).Interior.ColorIndex = 4                Else                ws.Range("J" & sumtablerow).Interior.ColorIndex = 3                End If'Opening has to be greater than zero    If opening > 0 Then'Set percent change equation    percent = (difference / opening)    ws.Range("K" & sumtablerow).Value = percent    ws.Range("K" & sumtablerow).NumberFormat = "0.00%"    End If    'Set new row for next ticker opening value    d = i + 1    'Print the ticker name in the summary table      ws.Range("I" & sumtablerow).Value = tickername'Print the total volume in the summary table      ws.Range("L" & sumtablerow).Value = totalvolume'Add one to the summary table row      sumtablerow = sumtablerow + 1      'Reset the total volume      totalvolume = 0'If the cell immediately following a row is the same ticker then    Else'Add to the total volume            totalvolume = totalvolume + ws.Cells(i, 7).Value    End If  Next i  lastrowhard = ws.Cells(Rows.Count, 9).End(xlUp).Rowmaxpercentinitial = ws.Cells(2, 11).Valueminpercentinitial = ws.Cells(2, 11).Valuemaxvolumeinitial = ws.Cells(2, 12).Valuemaxpercent = 0minpercent = 0maxvolume = 0'Finding max percent in summary table loopFor j = 3 To lastrowhard    If ws.Cells(j, 11).Value >= maxpercentinitial Then                maxpercentinitial = ws.Cells(j, 11).Value        tickernamehard1 = ws.Cells(j, 9).Value                End IfNext jmaxpercent = maxpercentinitial    ws.Cells(2, 17).Value = maxpercent    ws.Cells(2, 17).NumberFormat = "0.00%"    ws.Cells(2, 16).Value = tickernamehard1'Finding min percent in summary table loopFor h = 3 To lastrowhard    If ws.Cells(h, 11).Value <= minpercentinitial Then                minpercentinitial = ws.Cells(h, 11).Value        tickernamehard2 = ws.Cells(h, 9).Value            End IfNext hminpercent = minpercentinitial    ws.Cells(3, 17).Value = minpercent    ws.Cells(3, 17).NumberFormat = "0.00%"    ws.Cells(3, 16).Value = tickernamehard2'Finding max volume in summary table loopFor k = 3 To lastrowhard    If ws.Cells(k, 12).Value >= maxvolumeinitial Then                maxvolumeinitial = ws.Cells(k, 12).Value        tickernamehard3 = ws.Cells(k, 9).Value            End IfNext kmaxvolume = maxvolumeinitial    ws.Cells(4, 17).Value = maxvolume    ws.Cells(4, 16).Value = tickernamehard3           Next wsEnd Sub